function getLinkUrl(e){return location.protocol=="https:"&&/^http:\/\/www\.so\.com\/link\?url=/i.test(e)?So.lib.parseQuery(e).url:e}(function(){function HotwordDataSource(e){var t=this;this.url=e.url,this.suggest=null,this.whichPage=null,this.data=null,this.historyData=null,this.historyInited=!1,this.loading=!1,this.displaying=!1,this.canceled=!1,this.isPrivacyMode=!1,window.hotword=function(e){if(So.lib.soLocalStorage&&$.isArray(e)&&e.length>0){var n={time:So.comm.t,data:e};So.lib.soLocalStorage.setItem(storageKey,JSON.stringify(n))}t.dataLoaded(e)}}function html_encode(e){var t="";return e.length==0?"":(t=e.replace(/&/g,"&amp;"),t=t.replace(/</g,"&lt;"),t=t.replace(/>/g,"&gt;"),t=t.replace(/\'/g,"&#39;"),t=t.replace(/\"/g,"&quot;"),t=t.replace(/\n/g,"<br>"),t)}function ComboBox(e){mix(this,e),this.render()}function getStorage(e,t){if(t.length==0)return t;var n=[],r=So.lib.soLocalStorage.getItem("sosug");r?r=JSON.parse(r):r=[];var i=[];for(var s=0,o=r.length;s<o;s++){var u=decodeURIComponent(r[s].word).toLowerCase();if(oText.value.toLowerCase()!=u&&u.indexOf($.trim(e).toLowerCase())==0){r[s].word=u.replace(/[<>]/g,""),r[s].storage=1,i.push(r[s]);if(i.length==2)break}}var a=0;for(var s=0,o=t.length;s<o;s++){var f=!1;if(t[s].storage)continue;s==0&&t[s].obdata&&(i=[]);for(var l=0,c=i.length;l<c;l++)if(t[s].word==i[l].word){f=!0;break}if(!f){n.push(t[s]),a++;if(a>=10-i.length)break}}return i.length>0&&monitor.setConf("clickUrl","//s.360.cn/so/click.gif").log({pro:"so",pid:So.comm.pid||"",mod:"sugshow",num:i.length},"click"),i.concat(n)}var storageKey="haoSouHotWord";HotwordDataSource.prototype={loadData:function(){var e=this;if(e.whichPage==1&&cb.localSave&&!e.isPrivacyMode){e.historyData=e.getHistoryData("sosug"),e.render();return}if(e.whichPage==0){e.loading=!0;if(e.data)e.dataLoaded(e.data);else{var t=null;if(So.lib.soLocalStorage){var n=So.lib.soLocalStorage.getItem(storageKey),r;n&&(n=JSON.parse(n),t=n.data,r=n.time)}!t||t&&r+3e5<So.comm.t?loadJs(e.url):e.dataLoaded(t)}}},dataLoaded:function(e){this.data=e,this.loading=!1,this.render(),So.lib.log("suggest-log",{type:"hot-show"})},setWhichPage:function(e){this.whichPage=e},setSuggest:function(e){this.suggest=e},getHistoryData:function(e){var t=this,n=[];return So.lib.soLocalStorage&&(n=So.lib.soLocalStorage.getItem(e),n?n=JSON.parse(n):n=[]),n},render:function(){this.displaying=!0;var e=this.suggest,t="",n=this;if(n.historyData)for(var r=0,i=n.historyData.length;r<i;r++){if(r==8)break;t+='<li class="local" unselectable="on" ac_index="'+r+'" acvalue="'+html_encode(decodeURIComponent(n.historyData[r].word))+'" data-type="local-sug"><span unselectable="on" title="\u5728\u9996\u9875\u8bbe\u7f6e\u4e2d\u53ef\u5173\u95ed\u641c\u7d22\u5386\u53f2\u8bb0\u5f55\u54e6~" class="del">\u5220\u9664</span>'+html_encode(decodeURIComponent(n.historyData[r].word))+"</li>"}else if(n.data)for(var s=0,o=n.data.length;s<o;s++){if(s==8)break;var u=n.data[s];t+='<li class="clearfix" data-type="hotword" unselectable="on" ac_index="'+s+'" acvalue="'+html_encode(u[0])+'"><em'+(s<3?' class="hot"':"")+">"+(s+1)+'</em><span unselectable="on" '+(u[2]?' class="new"':"")+">"+u[0]+"</span></li>"}t!=""?(e.oMenu.innerHTML=t,e.oMenu.setAttribute("ac_word",""),e.oMenu.setAttribute("ver",""),e.selectedIndex=-2,e.show(),n.historyData&&e.sugStorageDel(),!n.historyInited&&n.historyData&&(So.lib.log("suggest-log",{type:"home-history-show"}),n.historyInited=!0)):(e.oMenu.innerHTML=t,e.hide(),e.selectedIndex=-2)},hide:function(){this.suggest.hide(),this.displaying=!1},cancel:function(e){this.canceled=e,e&&this.displaying&&this.hide()}};var loadJs=function(e){var t=document.getElementsByTagName("head")[0]||document.documentElement,n=document.createElement("script"),r=!1;n.src=e,n.charset="utf-8",n.onerror=n.onload=n.onreadystatechange=function(){!r&&(!this.readyState||this.readyState=="loaded"||this.readyState=="complete")&&(r=!0,t.removeChild(n))},t.insertBefore(n,t.firstChild)},mix=function(e,t){for(var n in t)e[n]=t[n];return e},createElement=function(e,t){return mix(document.createElement(e),t)},target=function(e){return e=e||window.event,e.target||e.srcElement},keyCode=function(e){return e=e||window.event,e.which||e.keyCode||e.charCode},preventDefault=function(e){e=e||window.event,e.preventDefault&&e.preventDefault()||(e.returnValue=!1),e.stopPropagation&&e.stopPropagation()},hasClass=function(e,t){return(new RegExp("(?:^|\\s)"+t+"(?:\\s|$)","i")).test(e.className)},addClass=function(e,t){hasClass(e,t)||(e.className=(e.className+" "+t).replace(/^\s+|\s+$/g,""))},removeClass=function(e,t){hasClass(e,t)&&(e.className=e.className.replace(new RegExp("(?:\\s|^)"+t+"(?:\\s|$)","i")," ").replace(/^\s+|\s+$/g,""))},ancestorNode=function(e,t,n){do if(e.tagName==t)return e;while(e!=n&&(e=e.parentNode));return null},on=function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)},cutSite=function(e,t,n){var r=e.split("://");r.shift();var i=parseInt(cb.width)-t.length*15-5-(n?16:29)-15,s=r.join("");return s.charAt(s.length-1)=="/"&&(s=s.substr(0,s.length-1)),s.length*7>i&&(s=s.substr(0,Math.floor(i/7)-2)+".."),s},kwValidate=function(e){return e.length>3||e.length>1&&/[\u4e00-\u9fa5]/.test(e)?!0:!1},isIe=/msie/i.test(navigator.userAgent),oneUrl=null;ComboBox.prototype={width:0,oText:null,itemsData:null,oneData:null,oMenu:null,oWrap:null,oOne:null,selectedIndex:-2,filteredValue:"",filteringValue:"",acValue:"",closed:!1,richData:{},richClosed:!1,showCount:0,isCreateWidth:!0,focusByClick:!1,show:function(){(this.options.enableHotword||this.oText.value)&&this.oMenu.childNodes.length&&(this.oWrap.style.display="",this.closed=!1)},hide:function(e){typeof this.beforeHide=="function"&&this.beforeHide(),this.oWrap.style.display="none",this.closed=!0},refreshOne:function(){var e=this,t=e.oneData;if(t){if(!t.__isItemsDataRendered){var n=[];if(t.h){var r=t.s||t.q,i=!1;n.push('<a href="',t.h,'" target="_blank">'),t.f&&(n.push('<img src="',t.f,'" >'),i=!0),n.push("<b>",r,"</b>"),i||n.push('<<span class="tag_site">\u5b98\u7f51</span>>'),n.push('<span class="site_url">',cutSite(t.h,r,i),"</span></a>")}e.oOne.innerHTML=n.join("").replace(/(<\w+)/g,'$1 unselectable="on"'),t.__isItemsDataRendered=!0}}else e.oOne.innerHTML=""},refreshItems:function(e){var t=this,n=t.itemsData;if(t.oText.value!=t.query)return;if(n&&!n.__isItemsDataRendered||e){var r=[],i=Math.min(t.showCount,n.length);for(var s=0;s<i;s++)n[s].storage==1?r.push('<li class="local" ac_index="'+s+'" acValue="'+n[s].sVal.replace(/&/g,"&amp;").replace(/"/g,"&quot;")+'" data-type="local"><span unselectable="on" class="del" title="\u5728\u9996\u9875\u8bbe\u7f6e\u4e2d\u53ef\u5173\u95ed\u641c\u7d22\u5386\u53f2\u8bb0\u5f55\u54e6~">\u5220\u9664</span>'+n[s].sTitle+"</li>"):r.push('<li ac_index="'+s+'" acValue="'+n[s].sVal.replace(/&/g,"&amp;").replace(/"/g,"&quot;")+'">'+n[s].sTitle+"</li>");t.oMenu.innerHTML=r.join("").replace(/(<\w+)/g,'$1 unselectable="on"'),t.oMenu.setAttribute("ac_word",t.query),t.oMenu.setAttribute("ver",t.version),n.length?t.show():t.hide(),t.filteredValue=t.filteringValue,t.acValue="",t.selectedIndex=-2,removeClass(t.oOne,"selected"),n.__isItemsDataRendered=!0;var o=document.getElementById("provided-by");o.style.position="static",o.style.position="absolute";for(var u in t.richData){var a=t.richData[u];t.richShow[a.t]&&t.richShow[a.t].call(t,a.index,a.d)}t.findStorageDel()}},findStorageDel:function(){var e=this;$(e.oMenu).find(".local span").on("click",function(t){var n=$(this).parent(".local");e.delStorage(n.attr("acvalue")),e.itemsData.splice(n.attr("ac_index"),1),e.refreshItems(!0),preventDefault(t),So.lib.log("suggest-log",{type:"typing-sug-dele"})})},sugStorageDel:function(){var e=this;$(e.oMenu).find(".local span").on("click",function(t){var n=$(this).parent(".local");e.delStorage(n.attr("acvalue")),hotwordDataSource.loadData(),preventDefault(t),So.lib.log("suggest-log",{type:"home-sug-dele"})})},delStorage:function(e){if(!e)return;var t=hotwordDataSource.getHistoryData("sosug");e=encodeURIComponent(e);for(var n=0,r=t.length;n<r;n++)t[n]&&t[n].word.toLowerCase()==e.toLowerCase()&&t.splice(n,1);So.lib.soLocalStorage.setItem("sosug",JSON.stringify(t))},richAtom:{classOne:function(e,t,n,r,i){var s=this,o=s.oMenu,u=s.oMenu.getElementsByTagName("li")[e],a=[];a.push('<span class="official" unselectable="on">'+t+"</span>"),a.push('<span class="subheading" unselectable="on">'+r+"</span>"),u.innerHTML=a.join("")+'<span class="headline" unselectable="on">'+i+"</span>",u.style.borderBottom="1px #eee solid",u.setAttribute("data-type",n)}},richShow:{new_service:function(e,t){var n=this,r=t[0],i=t[1];r+=t[2]>1?"(\u5171"+t[2]+"\u4e2a)":"",n.richAtom.classOne.call(n,e,"\u5b98\u65b9","new_service",r,i)},video:function(e){var t=this,n=t.oMenu,r=t.oMenu.getElementsByTagName("li")[e];r.innerHTML=('<span class="headline-re">'+r.innerHTML+'<b class="recommend"></b></span>').replace(/(<\w+)/g,'$1 unselectable="on"'),r.setAttribute("data-type","video")},postcode_new:function(e,t){var n=this,r=t[0],i=t[1];n.richAtom.classOne.call(n,e,"\u90ae\u7f16","postcode_new",r,i)},areacode:function(e,t){var n=this,r=t[0],i=t[1];n.richAtom.classOne.call(n,e,"\u533a\u53f7","areacode",r,i)},astro2_card:function(e,t){var n=this,r=t[0],i=t[1]+"("+t[2]+")";n.richAtom.classOne.call(n,e,"\u661f\u5ea7","astro2_card",r,i)},baike_struct:function(e,t){var n=this,r=t[0],i=t[1];n.richAtom.classOne.call(n,e,"\u67e5\u8be2","baike_struct",r,i)},jieri_card:function(e,t){var n=this,r=t[0],i=t[1];n.richAtom.classOne.call(n,e,"\u65e5\u5386","jieri_card",r,i)},hanzi_card:function(e,t){var n=this,r=t[0],i="";if($.isArray(t[1]))for(var s=0;s<t[1].length;s++)i+="["+t[1][s]+"] ";else i=t[1];n.richAtom.classOne.call(n,e,"\u5b57\u5178","hanzi_card",r,i)},miyu_card:function(e,t){var n=this,r=t[0],i=t[1];n.richAtom.classOne.call(n,e,"\u67e5\u8be2","miyu_card",r,i)}},richDot:{mouseDown:function(e){$(".ac_wrap").delegate("li","mousedown",function(t){var n=$(this),r=n.attr("data-type"),i="";r!=null?$(t.target).hasClass("del")||monitor.setConf("wpoUrl"," //s.360.cn/so/disp.gif").log({pro:"so",pid:So.comm.pid||"",mod:"sug-"+r+"-click",input:encodeURIComponent(e.oText.value),content:encodeURIComponent(n.html().replace(/<[^>].*?>/g,"\n"))},"wpo"):($.each(n.siblings(),function(){var e=$(this);currType=e.attr("data-type"),currType!=null&&(r=currType,i+=e.html()+" || ")}),i!=""&&monitor.setConf("wpoUrl"," //s.360.cn/so/disp.gif").log({pro:"so",pid:So.comm.pid||"",mod:"has-rich-"+r,input:encodeURIComponent(e.oText.value),content:encodeURIComponent(i.replace(/<[^>].*?>/g,"\n"))},"wpo"))})},show:function(e,t){monitor.setConf("wpoUrl"," //s.360.cn/so/disp.gif").log({pro:"so",pid:So.comm.pid||"",mod:"sug-"+e+"-show",input:encodeURIComponent(t)},"wpo")}},setSelectedIndex:function(e,t){var n=this,r=n.oMenu.childNodes;if(r.length){n.selectedIndex>-1&&removeClass(r[n.selectedIndex],"selected"),removeClass(n.oOne,"selected"),e=(e+r.length+2)%(r.length+2);if(e==r.length)n.acValue=n.oText.value=n.filteringValue,e=-2;else if(e==r.length+1){if(!n.oOne.innerHTML)return n.setSelectedIndex(-2-n.selectedIndex,t),!1;n.acValue=n.oText.value=n.oOne.getElementsByTagName("b")[0].innerHTML,addClass(n.oOne,"selected"),e=-1}else n.acValue=n.oText.value=r[e].getAttribute("acValue"),addClass(r[e],"selected")}else e=-2;n.selectedIndex=e;if(n.afterSetSelectedIndex){var i={inputValue:n.filteredValue,index:e,word:n.acValue,type:e>=0?r[e].getAttribute("data-type"):""};n.afterSetSelectedIndex(i)}},render:function(){function a(t){e.closed&&e.show(),clearInterval(e._refreshTimer),e._refreshTimer=setInterval(function(){if(f)return!1;var t=r.value,n=t.indexOf("?");n!=-1&&(t=t.substr(0,n));var i=e.options.enableHotword&&(!e.options.clickEmptyToTriggerHotword||e.focusByClick);i&&hotwordDataSource.cancel(t&&t!=e.acValue),t?(t!=e.filteredValue&&t!=e.filteringValue&&t!=e.acValue&&(e.filteringValue=t,e.refreshData()),e.itemsData&&e.refreshItems(),oneUrl&&e.refreshOne()):(e.acValue=e.filteringValue=e.filteredValue="",i?!hotwordDataSource.loading&&!hotwordDataSource.displaying&&hotwordDataSource.loadData():e.hide())},100)}var e=this;if(e._rendered)return;e._rendered=!0;var t='<div class="ac_wrap_inner"><div class="ac_menu_ctn"><div id="ac_one"></div><ul class="ac_menu"></ul></div><div id="provided-by" class=ac_toolbar>\u7531360\u641c\u7d22\u63d0\u4f9b</div></div>';/msie[ \/os]*6\./ig.test(navigator.userAgent)&&(t='<iframe class="ac_bgIframe" frameBorder="0"></iframe>'+t);var n=createElement("div",{className:"ac_wrap",innerHTML:t.replace(/(<\w+)/g,'$1 unselectable="on"')}),r=e.oText,i=e.oPos||r;i.parentNode.insertBefore(n,i);var s=e.oMenu=n.getElementsByTagName("ul")[0],o=e.oOne=document.getElementById("ac_one");r.setAttribute("autoComplete","off");if(e.isCreateWidth){var u=e.oText.getAttribute("suggestWidth")||i.offsetWidth+"px";isIe?n.style.width=u:n.style.minWidth=u}n.style.top=i.offsetHeight-1+"px",n.style.left=i.offsetLeft+"px",e.oWrap=n,e.width=u,e.hide(),on(e.oText,"dblclick",function(t){e.show()}),on(e.oText,"keydown",function(t){var r=keyCode(t),i=0;switch(r){case 40:i=1;break;case 38:i=-1;break;case 27:e.closed||(e.hide(),preventDefault(t));break;case 13:if(e.selectedIndex==-1){var s=e.oOne.getElementsByTagName("a")[0];if(s){var o=document.forms[0];o.target="_blank",o.action=s.href;var u=document.getElementsByTagName("input");for(var a=0;a<u.length;a++){var f=u[a];f.setAttribute("data-name",f.name),f.removeAttribute("name")}setTimeout(function(){o.target="_self",o.action="/s";for(var t=0;t<u.length;t++){var n=u[t];n.setAttribute("name",n.getAttribute("data-name"))}e.oText.blur()},200)}}}i&&(preventDefault(t),n.style.display=="none"?e.show():e.setSelectedIndex(e.selectedIndex+i))}),e.localSave&&So.lib.soLocalStorage&&typeof JSON!="undefined"&&on(e.oText.form,"submit",function(t){var n=$.trim(e.oText.value),r=/[^\x00-\xff]/g;if(n.replace(r,"mm").length<=4||n.replace(r,"mm").length>40)return;n=encodeURIComponent(n);var i=hotwordDataSource.getHistoryData("sosug"),s=!1,o=0;$.each(i,function(e,t){t.word.toLowerCase()==n.toLowerCase()&&(s=!0,o=e)}),s&&i.splice(o,1),i.unshift({word:n}),i.length>30&&i.pop(),So.lib.soLocalStorage.setItem("sosug",JSON.stringify(i))}),on(e.oText,"focus",a),on(e.oText,"click",function(){e.oText.value||(e.focusByClick=!0)}),on(r.form,"submit",function(t){if(e.onBeforeSubmit&&e.selectedIndex>=0){var n=e.oMenu.children[e.selectedIndex],i={inputValue:r.value,index:parseInt(n.getAttribute("ac_index"),10),word:n.getAttribute("acvalue"),type:n.getAttribute("data-type")};e.onBeforeSubmit(i)===!1&&preventDefault(t)}setTimeout(function(){e&&(e.oText.blur(),e.acValue=e.filteringValue=e.filteredValue="",e.oMenu.innerHTML="",e.selectedIndex=-2,hotwordDataSource.displaying=!1)},20)}),on(e.oText,"blur",function(t){e.hide(),clearInterval(e._refreshTimer)});var f,l;n.onmousedown=function(e){var t=target(e),n=ancestorNode(t,"LI",s);preventDefault(e),clearTimeout(l),f=!0,l=setTimeout(function(){f=!1},2e3)},s.onclick=function(t){var n=target(t),i=ancestorNode(n,"LI",s);if(i){r.blur(),setTimeout(function(){r.focus()},10);var o=0,u=i,a=r.value;while(u=u.previousSibling)o++;e.setSelectedIndex(o,!0),e.hide(),clearInterval(e._refreshTimer);var f={index:parseInt(i.getAttribute("ac_index"),10),word:i.getAttribute("acvalue"),type:i.getAttribute("data-type"),inputValue:a};e.onselectitem&&e.onselectitem(f)}},s.onmouseover=function(t){var n=target(t),r=ancestorNode(n,"LI",s);r&&(e.enableHoverState?addClass(r,"hover"):(e.selectedIndex>-1&&removeClass(e.oMenu.childNodes[e.selectedIndex],"selected"),addClass(r,"selected"),e.selectedIndex=parseInt(r.getAttribute("ac_index"))))},s.onmouseout=function(t){var n=target(t),r=ancestorNode(n,"LI",s);r&&(e.enableHoverState?removeClass(r,"hover"):removeClass(r,"selected"))},o.onclick=function(t){var n=target(t),i=ancestorNode(n,"A",o);i&&(r.blur(),e.hide(),clearInterval(e._refreshTimer),e.setSelectedIndex(-1,!0))},o.onmouseover=function(t){addClass(e.oOne,"selected"),e.selectedIndex>-1&&removeClass(e.oMenu.childNodes[e.selectedIndex],"selected"),e.selectedIndex=-1},o.onmouseout=function(t){removeClass(e.oOne,"selected")},n.onmouseout=function(t){e.enableHoverState||(e.selectedIndex>-1?removeClass(e.oMenu.childNodes[e.selectedIndex],"selected"):e.selectedIndex==-1&&removeClass(e.oOne,"selected"),e.selectedIndex=-2)},document.activeElement===e.oText&&a(),e.richDot.mouseDown(e)}};var oText=null,dataCache={},oneCache={},cb=null,callbackFunctionName,hotwordDataSource=new HotwordDataSource({url:"//www.so.com/zt/api/hotword.js"}),callbackFunction=function(data,adpted){cb.dataAdapter&&!adpted&&(data=cb.dataAdapter(data));var ar=[],menuData=data.result||[],version=data.version||"",kw=oText.value,richData=[],richType=null,richNum=null,isOverstep=!1,isShowOne=!0;if(cb.localSave&&So.lib.soLocalStorage&&typeof JSON!="undefined"&&!hotwordDataSource.isPrivacyMode){var word=$.trim(oText.value),r=/[^\x00-\xff]/g;word.replace(r,"mm").length>=4&&(menuData=getStorage(kw,menuData))}for(var i=0,len=menuData.length;i<len;i++){var key=menuData[i].word,val=key,rule=menuData[i].obdata;kw&&val.toLowerCase().indexOf(kw.toLowerCase())===0&&(val=val.substr(0,kw.length)+"<b>"+val.substr(kw.length)+"</b>"),key&&ar.push({sVal:key,sTitle:val,storage:menuData[i].storage||0}),rule&&!cb.richClosed&&!isOverstep&&(rule=eval("("+rule+")"),richType==null&&(!rule.d||!!rule.d&&!!rule.d[0]&&!!rule.d[1])&&(rule.t=="new_service"||rule.t=="video"||rule.t=="postcode_new"||rule.t=="areacode"||rule.t=="astro2_card"||rule.t=="baike_struct"||rule.t=="jieri_card"||rule.t=="hanzi_card"||rule.t=="miyu_card")&&(richType=rule.t,richNum=cb.richRule[rule.t]?cb.richRule[rule.t].num?cb.richRule[rule.t].num:1:1),isOverstep=i>=richNum?!0:isOverstep,rule.t==richType&&i<richNum&&(cb.richDot.show(richType,data.query),richData.push(mix({index:i},rule)),i==0&&rule.t!="video"&&(isShowOne=!1)))}cb.richData=richData,cb.query=data.query,cb.itemsData=ar,cb.version=version,data.query&&(dataCache[data.query]=data);if(isShowOne&&oneUrl&&menuData[0]){var val=menuData[0].word,one2=oneCache[val],one1=oneCache[kw];one1?one1.msg?callbackOne(one1,!0):kwValidate(kw)&&one2?callbackOne(one2,!0):callbackOne(one1,!0):(kw.length>1&&(/[\u4e00-\u9fa5]/.test(kw)?loadJs(oneUrl+"&q1="+encodeURIComponent(kw)+"&q2="+encodeURIComponent(val)):kwValidate(kw)&&loadJs(oneUrl+"&q1=%20&q2="+encodeURIComponent(val))),oneCache[kw]={})}else richData.length>0&&callbackOne({errno:0,msg:""},!0)},callbackOne=function(data,adpted){cb.oneAdapter&&!adpted&&(data=cb.oneAdapter(data),data.msg&&data.msg.Host&&window.AC_ONE_SHOW&&window.AC_ONE_SHOW(data.msg.Host));var msg=data&&data.msg||{};typeof msg=="string"&&(msg=eval("("+msg+")"));if(!msg.Query||msg.Query==oText.value||msg.Query==cb.itemsData[0].sVal)cb.oneData={h:msg.Host,f:So.lib.sslReplace(msg.Favicon),s:msg.SiteName,q:msg.Query};msg&&msg.Query&&(oneCache[msg.Query]=data)},createSuggest=function(e){e=mix({clickEmptyToTriggerHotword:!1,enableHotword:!1,alignElement:e.inputElement,pqElement:"",urlPrefix:"http://sug.so.360.cn/suggest/word?callback=suggest_so&encodein=utf-8&encodeout=utf-8&word=",enableHoverState:!1,richRule:{video:{num:3}},localSave:0,showCount:10,isCreateWidth:!0},e);var t=e.urlPrefix.match(/callback=(\w+)/)[1];window[t]=callbackFunction;if(e.urlOne&&/callback=(\w+)/.test(e.urlOne)){oneUrl=e.urlOne;var n=RegExp.$1;window[n]=callbackOne}oText=e.inputElement,cb=window.cb=new ComboBox({options:e,oText:oText,oPos:e.alignElement,enableHoverState:e.enableHoverState,dataAdapter:e.dataAdapter,oneAdapter:e.oneAdapter,beforeHide:e.beforeHide||function(){},afterSetSelectedIndex:e.afterSetSelectedIndex,beforeSelectItem:e.beforeSelectItem,onBeforeSubmit:e.onBeforeSubmit,richRule:e.richRule,localSave:e.localSave,showCount:e.showCount,isCreateWidth:e.isCreateWidth,onselectitem:function(e){if(this.beforeSelectItem&&this.beforeSelectItem(e)===!1)return;var t=oText.form.elements;for(var n=0;n<t.length;n++)if(t[n].type=="submit"){t[n].click();return}},refreshData:function(){var t=dataCache[oText.value];t?callbackFunction(t,!0):e.pqElement?loadJs(e.urlPrefix+encodeURIComponent(oText.value)+"&pq="+encodeURIComponent(e.pqElement.value)):loadJs(e.urlPrefix+encodeURIComponent(oText.value))}}),hotwordDataSource.setSuggest(cb),hotwordDataSource.setWhichPage(e.whichPage||0)};window.clearSugStorage=function(){So.lib.soLocalStorage&&So.lib.soLocalStorage.removeItem("sosug")},setTimeout(function(){try{external.AppCmd(external.GetSID(window),"sesafe","GetIncognitoStatus","1","",function(e,t){100==e&&t=="true"&&(hotwordDataSource.isPrivacyMode=!0)})}catch(e){}},30),window.createSuggest=createSuggest})(),function(){if(typeof window.monitor!="undefined")return;var e="V1.2.2(2012.8.7)",t="360.cn",n=function(r,s){var o=document,u=navigator,f=r.screen,l=document.domain.toLowerCase(),h=u.userAgent.toLowerCase(),p={trim:function(e){return e.replace(/^[\s\xa0\u3000]+|[\u3000\xa0\s]+$/g,"")}},d={on:function(e,t,n){e.addEventListener?e&&e.addEventListener(t,n,!1):e&&e.attachEvent("on"+t,n)},parentNode:function(e,t,n){n=n||5,t=t.toUpperCase();while(e&&n-->0){if(e.tagName===t)return e;e=e.parentNode}return null}},v={fix:function(e){if(!("target"in e)){var t=e.srcElement||e.target;t&&t.nodeType==3&&(t=t.parentNode),e.target=t}return e}},m=function(){function e(e){return e!=null&&e.constructor!=null?Object.prototype.toString.call(e).slice(8,-1):""}return{isArray:function(t){return e(t)=="Array"},isObject:function(e){return e!==null&&typeof e=="object"},mix:function(e,t,n){for(i in t)if(n||!(e[i]||i in e))e[i]=t[i];return e},encodeURIJson:function(e){var t=[];for(var n in e){var r=e[n];if(typeof r=="undefined")continue;/^(password|pass|username)$/i.test(n)&&(n="__key__",r="__val__"),/(password|pass|username)=/i.test(e[n])&&(r="__val__"),t.push(encodeURIComponent(n)+"="+encodeURIComponent(r))}return t.join("&")}}}(),g={get:function(e){var t,n=new RegExp("(^| )"+e+"=([^;]*)(;|$)");return(t=o.cookie.match(n))?unescape(t[2]):""},set:function(e,t,n){n=n||{};var r=n.expires;typeof r=="number"&&(r=new Date,r.setTime(r.getTime()+n.expires)),o.cookie=e+"="+escape(t)+(r?";expires="+r.toGMTString():"")+(n.path?";path="+n.path:"")+(n.domain?"; domain="+n.domain:"")}},y={getProject:function(){return""},getReferrer:function(){return o.referrer},getBrowser:function(){var e={"360se-ua":"360se",TT:"tencenttraveler",Maxthon:"maxthon",GreenBrowser:"greenbrowser",Sogou:"se 1.x / se 2.x",TheWorld:"theworld"};for(i in e)if(h.indexOf(e[i])>-1)return i;var t=!1;try{+external.twGetVersion(external.twGetSecurityID(r)).replace(/\./g,"")>1013&&(t=!0)}catch(n){}if(t)return"360se-noua";var s=h.match(/(msie|chrome|safari|firefox|opera)/);return s=s?s[0]:"",s=="msie"&&(s=h.match(/msie[^;]+/)),s},getLocation:function(){var e="";try{e=location.href}catch(t){e=o.createElement("a"),e.href="",e=e.href}return e=e.replace(/[?#].*$/,""),e=/\.(s?htm|php)/.test(e)?e:e.replace(/\/$/,"")+"/",e},getGuid:function(){function e(e){var t=0,n=0,r=e.length-1;for(r;r>=0;r--){var i=parseInt(e.charCodeAt(r),10);t=(t<<6&268435455)+i+(i<<14),(n=t&266338304)!=0&&(t^=n>>21)}return t}function n(){var t=[u.appName,u.version,u.language||u.browserLanguage,u.platform,h,f.width,"x",f.height,f.colorDepth,o.referrer].join(""),n=t.length,i=r.history.length;while(i)t+=i--^n++;return(Math.round(Math.random()*2147483647)^e(t))*2147483647}var i="__guid",s=g.get(i);if(!s){s=[e(o.domain),n(),+(new Date)+Math.random()+Math.random()].join(".");var a={expires:2592e7,path:"/"};if(t){var c="."+t;if(l.indexOf(c)>0&&l.lastIndexOf(c)==l.length-c.length||l==c)a.domain=c}g.set(i,s,a)}return function(){return s}}(),getCount:function(){var e="count",t=g.get(e);return t=(parseInt(t)||0)+1,g.set(e,t,{expires:864e5,path:"/"}),function(){return t}}(),getFlashVer:function(){var e=-1;if(u.plugins&&u.mimeTypes.length){var t=u.plugins["Shockwave Flash"];t&&t.description&&(e=t.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s)+r/,".")+".0")}else if(r.ActiveXObject&&!r.opera)for(var n=16;n>=2;n--)try{var i=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+n);if(i){var s=i.GetVariable("$version");e=s.replace(/WIN/g,"").replace(/,/g,".")}}catch(o){}return e=parseInt(e,10),function(){return e}}(),getContainerId:function(e){var t=E.areaIds;if(t){var n,r=new RegExp("^("+t.join("|")+")$","ig");while(e){if(e.id&&r.test(e.id))return(e.getAttribute("data-desc")||e.id).substr(0,100);e=e.parentNode}}return""},getText:function(e){return p.trim((e.getAttribute("text")||e.innerText||e.textContent||e.title||"").substr(0,100))}},w={getBase:function(){return{p:y.getProject(),u:y.getLocation(),id:y.getGuid(),guid:y.getGuid()}},getTrack:function(){return{b:y.getBrowser(),c:y.getCount(),r:y.getReferrer(),fl:y.getFlashVer()}},getClick:function(e){e=v.fix(e||event);var t=e.target,n=t.tagName,r=y.getContainerId(t);if(t.type!="submit"){if(n=="AREA")return{f:t.href,c:"area:"+t.parentNode.name,cId:r};var i,s;return n=="IMG"&&(i=t),t=d.parentNode(t,"A"),t?(s=y.getText(t),{f:t.href,c:s?s:i.src.match(/[^\/]+$/),cId:r}):!1}var o=d.parentNode(t,"FORM");if(o){var u=o.id||"",a=t.id,f={f:o.action,c:"form:"+(o.name||u),cId:r};if((u=="search-form"||u=="searchForm")&&(a=="searchBtn"||a=="search-btn")){var l=S("kw")||S("search-kw")||S("kw1");f.w=l?l.value:""}return f}},getKeydown:function(e){e=v.fix(e||event);if(e.keyCode!=13)return!1;var t=e.target,n=t.tagName,r=y.getContainerId(t);if(n=="INPUT"){var i=d.parentNode(t,"FORM");if(i){var s=i.id||"",o=t.id,u={f:i.action,c:"form:"+(i.name||s),cId:r};if(o=="kw"||o=="search-kw"||o=="kw1")u.w=t.value;return u}}return!1}},E={trackUrl:null,clickUrl:null,areaIds:null},S=function(e){return document.getElementById(e)};return{version:e,util:y,data:w,config:E,sendLog:function(){return r.__monitor_imgs={},function(e){var t="log_"+ +(new Date),n=r.__monitor_imgs[t]=new Image;n.onload=n.onerror=function(){r.__monitor_imgs[t]=null,delete r.__monitor_imgs[t]},n.src=e}}(),buildLog:function(){var e="";return function(t,n){if(t===!1)return;t=t||{};var r=w.getBase();t=m.mix(r,t,!0);var i=m.encodeURIJson(t);if(i==e)return;e=i,setTimeout(function(){e=""},500),i+="&t="+ +(new Date),n=n.indexOf("?")>-1?n+"&"+i:n+"?"+i,this.sendLog(n)}}(),log:function(e,t){t=t||"click";var n=E[t+"Url"];n||alert("Error : the "+t+"url does not exist!"),this.buildLog(e,n)},setConf:function(e,t){var n={};return m.isObject(e)?n=e:n[e]=t,this.config=m.mix(this.config,n,!0),this},setUrl:function(e){return e&&(this.util.getLocation=function(){return e}),this},setProject:function(e){return e&&(this.util.getProject=function(){return e}),this},setId:function(){var e=[],t=0,n;while(n=arguments[t++])m.isArray(n)?e=e.concat(n):e.push(n);return this.setConf("areaIds",e),this},getTrack:function(){var e=this.data.getTrack();return this.log(e,"track"),this},getClickAndKeydown:function(){var e=this;return d.on(o,"click",function(t){var n=e.data.getClick(t);e.log(n,"click")}),d.on(o,"keydown",function(t){var n=e.data.getKeydown(t);e.log(n,"click")}),n.getClickAndKeydown=function(){return e},this}}}(window);n.setConf({trackUrl:"//s.360.cn/w360/s.htm",clickUrl:"//s.360.cn/w360/c.htm",wpoUrl:"//s.360.cn/w360/p.htm"}),window.monitor=n}(),monitor.setConf("feUrl","//s.qhupdate.com/sou/click_query.gif"),monitor.setConf("visit_durationUrl","//s.qhupdate.com/sou/visit_duration.gif"),monitor.util.getGuid=function(){return Tool.getGuid()};var Display={advert:function(e){if(!Tool.getURI("pn")||Tool.getURI("pn")=="pn=1"){var t=this,n=Tool.getURI("q"),r=$.extend({adtype:e.adtype,adcnt:e.adcnt,onpay:e.onpay},paramsComm);monitor.setConf("dispUrl","//s.qhupdate.com/sou/disp_ad.gif?"+n),monitor.log(r,"disp")}},moheLog:function(e){var t=this,n=Tool.getURI("q"),r=$.extend({},e,paramsComm);monitor.setConf("moheUrl","//s.qhupdate.com/sou/ob.gif?"+n),monitor.log(r,"mohe")}},paramsComm={};So.web._srp=function(){return function(){function srp(e,t){monitor.setConf("wpoUrl",e),monitor.log(t,"wpo")}paramsComm=$.extend({_guid:So.lib.cookie.get("__guid")||"",_huid:So.lib.cookie.get("__huid")||"",qid:So.comm.user.qid,pid:So.comm.pid,abv:So.comm.abv,src:So.comm.src},So.comm.monitor);var soadv=$(".adv-search-btn").attr("data-val"),engdetail=function(){var e=$("div[id^=mohe-]").length,t={},n="";$("a[data-res]").each(function(e,n){var r=$(n).data("res"),i=r.e||"";if(!i)return!0;t.hasOwnProperty(i)||(t[i]=0),t[i]++}),e>0&&(t.ob=e);for(engtype in t)n.length!==0&&(n+=","),n+=engtype+":"+t[engtype];return n}(),setLogHuid=function(){return paramsComm._huid?paramsComm._huid:So.lib.cookie.get("__huid")||""},resultClass=function(){var e=[],t=[];return $(".res-list").each(function(e,n){var r=$(n),i=r.find(".g-mohe"),s=r.find(".so-pdr");e+=1,i.length>0?t.push(e+":"+i.attr("id")):s.length>0?t.push(e+":"+s.attr("id")):t.push(e+":n")}),$("#side .g-mohe").each(function(t,n){e.push($(n).attr("id"))}),t.push("0:"+e.join("|")),t}();if($(".result-d").length>0){var srp=Tool.getURI("q"),params={},mp=eval("("+$(".result-d").attr("data-m")+")");params=$.extend({emp:mp.T},paramsComm),monitor.setConf("wpoUrl","//s.qhupdate.com/sou/srp_domain.gif?"+srp),monitor.log(params,"wpo")}$(".res-list").length>0&&srp("//s.qhupdate.com/sou/so.gif?"+Tool.getURI("q"),{});if($(".m-corr").length>0){var pUri="q="+encodeURIComponent(So.comm.q),params=$.extend({corr:$(".m-corr").attr("data-corr"),corrtype:$(".m-corr").attr("data-type"),corrver:$(".m-corr").attr("data-cid")},paramsComm);monitor.setConf("wpoUrl","//s.qhupdate.com/sou/disp_corr2.gif?"+pUri),monitor.log(params,"wpo")}if(document.cookie.indexOf("sgtclick=")>-1){var word,index,rs=[],sgt=So.lib.cookie.get("sgtclick"),params={};sgt!=""&&(rs=sgt.split("|"),clickValue=rs[0],index=rs[1],inputValue=rs[2],suggestValue=rs[3],pidValue=rs[4]||"result",version=rs[5]||"",params=$.extend({pro:So.comm.pid,mod:"suggest",input:suggestValue,click:clickValue,pos:1*index+1,v:version},paramsComm,{pid:pidValue,brand:"360"}),So.lib.cookie.remove("sgtclick"),monitor.setConf("clickUrl","//s.qhupdate.com/sou/suggest.gif"),monitor.log(params,"click"))}if($(".res-list").length>0){var v=$(".mod-relation").attr("data-version");if($("#rs a").length>0){var a=Tool.getURI("q"),b=["w"+$('#rs a[data-type="1"]').length,"n"+$('#rs a[data-type="0"]').length].join(""),d=$.extend({v:v,res:b,pn:Tool.getURI("pn")?Tool.getURI("pn").replace("pn=",""):1},paramsComm);monitor.setConf("wpoUrl","//s.qhupdate.com/sou/disp_rel.gif?"+a),monitor.log(d,"wpo")}else{var a=Tool.getURI("q"),d=$.extend({v:v,res:"w0n0",pn:Tool.getURI("pn")?Tool.getURI("pn").replace("pn=",""):1},paramsComm);monitor.setConf("wpoUrl","//s.qhupdate.com/sou/disp_rel.gif?"+a),monitor.log(d,"wpo")}}if($("#rs-top").length>0){var q=Tool.getURI("q"),pn=Tool.getURI("pn")?Tool.getURI("pn").replace("pn=",""):1;monitor.setConf("srpUrl","//s.qhupdate.com/so/srp.gif?"+q),monitor.log({pro:"www",pid:"result",mod:"rel_top",pn:pn},"srp")}if($("#side .so-cms").length>0){var $banner=$("#side .so-cms"),_type=$banner.attr("data-type")||"",_time=$banner.attr("data-time"),_val=So.lib.cookie.get("cms_"+_type)||0;So.lib.log("cms",{type:_type,datatype:"show",q:So.comm.q}),_val!=-1&&_time&&So.lib.cookie.set("cms_"+_type,parseInt(_val)+1,{expires:new Date(_time)})}$(".e-buss").length>0&&(monitor.setConf("pUrl","//i.qhupdate.com/p.gif"),monitor.log({sid:So.comm.monitor.sid},"p")),$(".e-buss a").on("mousedown",function(){So.lib.log("sda",{q:So.comm.q})}),$(".m-corr").delegate("a","mousedown",function(e){var t=Tool.getURI("q"),n=$.extend({corr:$(".m-corr").attr("data-corr"),select:$(".m-corr").attr("data-type")=="3"?$(this).text():$(".m-corr").attr("data-corr"),corrtype:$(".m-corr").attr("data-type"),corrver:$(".m-corr").attr("data-cid")},paramsComm);monitor.setConf("clickUrl","//s.qhupdate.com/sou/click_corr2.gif?"+t),monitor.log(n,"click")}),$(".result-d").delegate("a","mousedown",function(e){var target=e.target,pUri=Tool.getURI("q"),mp=eval("("+$(".result-d").attr("data-m")+")"),params=$.extend({emp:mp.T,link:target.href},paramsComm);monitor.setConf("clickUrl","//s.qhupdate.com/sou/click_domain.gif?"+pUri),monitor.log(params,"click")}),$(".so-pdr").delegate("a","mousedown",function(e){var t=e.target,n=Tool.getURI("q"),r=$(".so-pdr").has(t).attr("id").replace("so-pdr-",""),i=$(t).text(),s=$.extend({type:r,value:i,link:t.href,ver:$(".so-pdr").has(t).attr("data-ver"),datatype:$("#so_top").hasClass("scroll")?1:0},paramsComm);monitor.setConf("clickUrl","//s.qhupdate.com/sou/click_pdr.gif?"+n),monitor.log(s,"click")}),$("#main").delegate(".res-title a","mousedown",function(e){paramsComm._huid=setLogHuid();var t=e.target,n=$(this),r=n.data("res")||{},i=Tool.getURI("rg,site"),s=$(".res-title").has(this).find(".icon-official").length,o=n.parents("li.res-list"),u=n.attr("data-rank")?n.attr("data-rank"):1,a=n.attr("data-ver")||"",f=$.extend({q:So.comm.q,pn:So.comm.pn,utype:n.parents(".res-title"
).length>0?"main":"sub",value:n.attr("href"),pos:r.pos||"",et:r.e||"",engdetail:engdetail,rcs:r.c||"",official:s>0?1:0,tp:r.tp||"",from:r.fr||"",cat:n.attr("data-cat"),stp:(a?r.stp+"_"+a:r.stp)||"",rc:resultClass.join(","),guide:$("#so-pdr-guide").length>0?1:0,sz:o.length>0?o.width()+","+o.height():"",rank:u,soadv:soadv,x:So.lib.cookie.get("GUID")||"",sms:So.web.srplog.params.sms,ssl:location.protocol=="https:"?1:0},paramsComm);f.value=getLinkUrl(f.value),monitor.setConf("clickUrl","//s.qhupdate.com/sou/click_og.gif?"+i),monitor.log(f,"click")}),$("#main").delegate(".res-rich a","mousedown",function(e){paramsComm._huid=setLogHuid();if($(this).hasClass("m"))return;var t=e.target,n=$(this),r=$(".res-list").has(this).find(".res-title a[data-res]"),i=r.data("res")||{},s=Tool.getURI("rg,site"),o=n.attr("href"),u=r.attr("href"),a=n.attr("data-type"),f=n.attr("data-sign"),l=n.parents("li.res-list"),c=n.attr("data-rank")?n.attr("data-rank"):1,h=r.attr("data-ver")||"",p=$.extend({q:So.comm.q,pn:So.comm.pn,utype:"sub",value:u,sv:o,pos:i.pos||"",et:i.e||"",rcs:i.c||"",which:a,stp:(h?i.stp+"_"+h:i.stp)||"",sz:l.length>0?l.width()+","+l.height():"",rank:c,sign:f,soadv:soadv,x:So.lib.cookie.get("GUID")||"",sms:So.web.srplog.params.sms,ssl:location.protocol=="https:"?1:0},paramsComm);p.value=getLinkUrl(p.value),p.sv=getLinkUrl(p.sv),monitor.setConf("clickUrl","//s.qhupdate.com/sou/click_og.gif?"+s),monitor.log(p,"click")}),$("#warper div[id^=mohe-]").delegate("a,input[type=submit],input[type=button],button,[data-md]","mousedown",function(e){paramsComm._huid=setLogHuid();var params={q:So.comm.q,pn:So.comm.pn,comment:So.comm.hasTantan};this.href&&(params.type="link",params.value=$(this).attr("href"));var belongHolder=$(this).parents("div[id^=mohe-]"),mlink=belongHolder.eq(0).find("h3:first a:first").attr("href");params.mv=mlink||"",params.utype=$(this).parents("h3.title").length>0?"main":"sub";var holder=belongHolder.eq(belongHolder.length-1);params.sz=holder.width()+","+holder.height(),params.rank=params["utype"]=="main"?1:0,this.tagName.toLocaleLowerCase()=="input"&&(params.type="btn",$(this).attr("data-mk")?params.value=$(this).attr("data-mk"):params.value=$(".res-list div[id^=mohe-] form").has(this).attr("name"));if(this.tagName.toLocaleLowerCase()==="a"&&$(this).parents(".g-mohe").attr("id")==="mohe-qihuwenda"){var extJson=$(this).attr("data-ext");if(extJson)try{eval("var ext = "+extJson),params["ob-qihuwenda-mcid"]=ext.mcid,params["ob-qihuwenda-pos"]=ext.pos,params["ob-qihuwenda-cid"]=ext.cid}catch(ex){}}params.cat=[];var cat="";$(this).parents("div[id^=mohe-]").each(function(e,t){e==0&&(cat=t.id);var n=$(t).attr("data-abtest")||"";n&&(n="-"+n),params.cat.push(t.id+n)}),params.pos=$(".res-list").has("#"+cat).index()+1,params.cat=params.cat.join(","),params.soadv=soadv;var moheData=$(this).attr("data-md")||$(this).parents("[data-md]").attr("data-md"),moheGData=$(this).parents("[data-mgd]").attr("data-mgd");try{if(moheGData){moheGData=$.parseJSON(""+moheGData);for(var i in moheGData)params["md-"+i]=encodeURIComponent(moheGData[i])}if(moheData){moheData=$.parseJSON(""+moheData);for(var j in moheData)params["md-"+j]=encodeURIComponent(moheData[j])}}catch(e){console&&console.log(e)}params.engdetail=engdetail,params=$.extend(params,paramsComm),params.guide=$("#so-pdr-guide").length>0?1:0,params.rcs=resultClass.join(","),params.sms=So.web.srplog.params.sms,params.ssl=location.protocol=="https:"?1:0,params.value=getLinkUrl(params.value),params.mv=getLinkUrl(params.mv),monitor.setConf("clickUrl","//s.qhupdate.com/sou/click_ob.gif"),monitor.log(params,"click"),(this.tagName.toLocaleLowerCase()=="input"||this.tagName.toLocaleLowerCase()=="button"||this.tagName.toLocaleLowerCase()=="a")&&e.stopPropagation()}),$("#rs-top").delegate("a","mousedown",function(e){var t=e.target,n=Tool.getURI("q"),r=$("#rs a").index(t)+1,i=$(t).attr("data-type"),s=$(".mod-relation").attr("data-version"),o=$.extend({type:"top",word:monitor.util.getText(t),pos:r,rt:i,v:s,pn:Tool.getURI("pn")?Tool.getURI("pn").replace("pn=",""):1},paramsComm);monitor.setConf("clickUrl","//s.qhupdate.com/sou/click_rel.gif?"+n),monitor.log(o,"click")}),$("#rs").delegate("a","mousedown",function(e){var t=e.target,n=Tool.getURI("q"),r=$("#rs a").index(t)+1,i=$(t).attr("data-type"),s=$(".mod-relation").attr("data-version"),o=$.extend({word:monitor.util.getText(t),pos:r,rt:i,v:s,pn:Tool.getURI("pn")?Tool.getURI("pn").replace("pn=",""):1},paramsComm);monitor.setConf("clickUrl","//s.qhupdate.com/sou/click_rel.gif?"+n),monitor.log(o,"click")});if($(".toask").length>0){var srp=Tool.getURI("q,ie,_re"),params=$.extend({},paramsComm);monitor.setConf("wpoUrl","//s.qhupdate.com/sou/disp_tiwen.gif?"+srp),monitor.log(params,"wpo")}$(".toask").delegate("a","mousedown",function(e){var t=e.target,n=Tool.getURI("q,ie,_re"),r=$.extend({},paramsComm);r.pos=$(".toask").has(this).attr("data-pos"),monitor.setConf("clickUrl","//s.qhupdate.com/sou/click_tiwen.gif?"+n),monitor.log(r,"click")});var $cmsAdv=$("#side .so-cms");$cmsAdv.length>0&&$cmsAdv.on("mousedown",function(){var e=$(this),t=e.attr("data-type"),n=e.attr("data-time");So.lib.log("cms",{type:t,datatype:"click",q:So.comm.q}),n&&(n.length==10&&(n+=" 00:00:00"),So.lib.cookie.set("cms_"+t,"-1",{expires:new Date(n)}))}),$(".tantan-banner").length>0&&(So.lib.log("tantan-banner",{type:"show"}),$(".tantan-banner a").on("click",function(){So.lib.log("tantan-banner",{type:"click"})}));var $dataErro=$("#m-result").find("p[data-erro]");if($dataErro.length>0){var info=[];$.each($dataErro,function(){var e=$(this);info.push(e.attr("data-erro")+":"+$(e.parents(".res-list").find("a[data-res]")[0]).attr("href")+",")}),So.lib.log("res-erro",{q:So.comm.q,value:info.join("")})}}}(),So.web._srp(),So.page.reload.push(So.web._srp),function(){$("#g-hd-nav").delegate("a","mousedown",function(e){var t=e.target,n=Tool.getURI("q"),r={},i="";if(!$(t).attr("data-i")){i=$(t).text();switch(i){case"\u95ee\u7b54":i="wenda";break;case"\u65b0\u95fb":i="news";break;case"\u5730\u56fe":i="map";break;case"\u97f3\u4e50":i="music";break;case"\u89c6\u9891":i="video"}}else i=$(t).attr("data-i");r=$.extend({org:"web","new":i,type:"web"},paramsComm),monitor.setConf("clickUrl","//s.qhupdate.com/sou/engswitch.gif?"+n),monitor.log(r,"click")}),$(".hd-rtools").on("mousedown","a[data-log]",function(){So.lib.log("res-type",{q:So.comm.q,type:$(this).attr("data-log")})})}(),So.web._srp2=function(){return function(){if(!newMinotor)return;var log=function(e,t){var n=[];for(var r in t)n.push(r+"="+encodeURIComponent(t[r]));n="?"+n.join("&")+"&t="+ +(new Date);var i="so_"+ +(new Date),s=window[i]=new Image;s.src="//hs.qhupdate.com/sou/"+e+".gif"+n,s.onload=s.onerror=function(){window[i]=null,s=null}},resultClass=function(){var e=[],t=[];return $(".res-list").each(function(e,n){var r=$(n),i=r.find(".g-mohe"),s=r.find(".so-pdr");e+=1,i.length>0?t.push(e+":"+i.attr("id")):s.length>0?t.push(e+":"+s.attr("id")):t.push(e+":n")}),$("#side .g-mohe").each(function(t,n){e.push($(n).attr("id"))}),t.push("0:"+e.join("|")),t}(),getLinkUrl=function(e){return location.protocol=="https:"&&/http:\/\/www.so.com\/link\?url=/.test(e)?So.lib.parseQuery(e).url:e};$("#main").delegate(".res-title a","mousedown",function(e){var t=e.target,n=$(this),r=n.data("res")||{},i=n.parents("li.res-list"),s={sid:So.comm.monitor.sid,utype:n.parents(".res-title").length>0?"main":"sub",value:n.attr("href"),pos:r.pos||"",rc:resultClass.join(","),sz:i.length>0?i.width()+","+i.height():""};s.value=getLinkUrl(s.value),log("click_og",s)}),$("#main").delegate(".res-rich a","mousedown",function(e){if($(this).hasClass("m"))return;var t=e.target,n=$(this),r=$(".res-list").has(this).find(".res-title a[data-res]"),i=r.data("res")||{},s=n.attr("href"),o=r.attr("href"),u=n.attr("data-type"),a=n.parents("li.res-list"),f={sid:So.comm.monitor.sid,utype:"sub",value:o,sv:s,pos:i.pos||"",which:u,sz:a.length>0?a.width()+","+a.height():""};f.value=getLinkUrl(f.value),f.sv=getLinkUrl(f.sv),log("click_og",f)}),$("#warper div[id^=mohe-]").delegate("a,input[type=submit],input[type=button],button,[data-md]","mousedown",function(e){var params={};this.href&&(params.type="link",params.value=$(this).attr("href"));var belongHolder=$(this).parents("div[id^=mohe-]"),mlink=belongHolder.eq(0).find("h3:first a:first").attr("href");params.mv=mlink||"",params.utype=$(this).parents("h3.title").length>0?"main":"sub";var holder=belongHolder.eq(belongHolder.length-1);params.sz=holder.width()+","+holder.height(),this.tagName.toLocaleLowerCase()=="input"&&(params.type="btn",$(this).attr("data-mk")?params.value=$(this).attr("data-mk"):params.value=$(".res-list div[id^=mohe-] form").has(this).attr("name"));if(this.tagName.toLocaleLowerCase()==="a"&&$(this).parents(".g-mohe").attr("id")==="mohe-qihuwenda"){var extJson=$(this).attr("data-ext");if(extJson)try{eval("var ext = "+extJson),params["ob-qihuwenda-mcid"]=ext.mcid,params["ob-qihuwenda-pos"]=ext.pos,params["ob-qihuwenda-cid"]=ext.cid}catch(ex){}}params.cat=[];var cat="";$(this).parents("div[id^=mohe-]").each(function(e,t){e==0&&(cat=t.id);var n=$(t).attr("data-abtest")||"";n&&(n="-"+n),params.cat.push(t.id+n)}),params.pos=$(".res-list").has("#"+cat).index()+1,params.cat=params.cat.join(",");var moheData=$(this).attr("data-md")||$(this).parents("[data-md]").attr("data-md"),moheGData=$(this).parents("[data-mgd]").attr("data-mgd");try{if(moheGData){moheGData=$.parseJSON(""+moheGData);for(var i in moheGData)params["md-"+i]=encodeURIComponent(moheGData[i])}if(moheData){moheData=$.parseJSON(""+moheData);for(var j in moheData)params["md-"+j]=encodeURIComponent(moheData[j])}}catch(e){console&&console.log(e)}params.rcs=resultClass.join(","),params.sid=So.comm.monitor.sid,params.value=getLinkUrl(params.value),log("click_ob",params),(this.tagName.toLocaleLowerCase()=="input"||this.tagName.toLocaleLowerCase()=="button"||this.tagName.toLocaleLowerCase()=="a")&&e.stopPropagation()})}}(),So.web._srp2(),So.page.reload.push(So.web._srp2),So.comm.sug==1&&createSuggest({inputElement:document.getElementById("keyword"),alignElement:document.getElementById("suggest-align"),localSave:So.lib.cookie.get("sosug")=="1"?1:0,clickEmptyToTriggerHotword:!1,enableHotword:!0,whichPage:0,urlPrefix:"//sug.so.360.cn/suggest?callback=suggest_so&encodein=utf-8&encodeout=utf-8&format=json&fields=word,obdata&word=",onBeforeSubmit:function(e){var t=$(this.oMenu),n="srp_suggst",r=t.attr("ver")||"",i=t.attr("ac_word")||"",s=e.type=="hotword"?"result_hot":"result";switch(e.type){case"video":n="srp_suggst_v_"+r;break;case"new_service":n="srp_suggst_s_"+r;break;case"hotword":n="srp_suggst_hot";break;case"often-search":n="srp_suggst_often_search";break;default:n="srp_suggst_"+r}$(".src:first").val(n),So.lib.cookie.set("sgtclick",[e.word,e.index,e.inputValue,i,s,r].join("|"))},beforeHide:function(){var e=$(".src:first");e.attr("data-src")?e.val("srp_no_result"):e.val("srp")}}),function(){$("body").delegate("form .round","mouseenter",function(){$(this).addClass("hover")}),$("body").delegate("form .round","mouseleave",function(){$(this).removeClass("hover")}),$("body").delegate("form .input_key","focus",function(){$(this).parent(".round").addClass("focus")}),$("body").delegate("form .input_key","blur",function(){$(this).parent(".round").removeClass("focus")});var e=$(".input_key"),t=$(".search-del"),n=$(".ac_wrap"),r;t.click(function(){var r=$(this),i=t.index(r);e.eq(i).val("").focus(),n&&n.hide()}),e.focus(function(){var n=$(this),i=e.index(n),s=t.eq(i);clearInterval(r),r=setInterval(function(){$.trim(n.val())==""?s.hide():s.show()},100)}).blur(function(){var n=$(this),i=e.index(n),s=t.eq(i);clearInterval(r),$.trim(n.val())==""?s.hide():s.show()}),$("#mobile").on("click",function(){So.lib.cookie.remove("force_www_so")});var i=$("#g-hd-quser .user"),s=$("#g-hd-quser .usermenu"),o=null,u=null;i.hover(function(){clearTimeout(u),o=setTimeout(function(){s.show()},200)},function(){clearTimeout(o),u=setTimeout(function(){s.hide()},200)}),s.hover(function(){clearTimeout(u),o=setTimeout(function(){s.show()},200)},function(){clearTimeout(o),u=setTimeout(function(){s.hide()},200)})}(),So.web.feedback=function(){if(!/ipad/i.test(navigator.userAgent)&&!!document.createElement("canvas").getContext&&(OB.Browser.ie&&parseInt(OB.Browser.ie)>10||!OB.Browser.ie)){var e=$("#feedback_top"),t="feedback";_loader.add("require.2.1.11","http://s2.qhimg.com/!5a33324b/require.js"),$(".top-feedback").show(),e.on("click",function(){var n;$("#no-result").length>0?n=$("#no-result"):n=$("#main"),n.hasClass("feedback-mode")||(So.lib.log(t,{type:"main"}),n.addClass("feedback-mode"),_loader.use("require.2.1.11",function(){require(["/resource/js/feedback.js"],function(t){t.init({$targetDom:n,$feedbackBtn:e,posFlag:1,exitCallBack:function(){n.removeClass("feedback-mode")}})})}))});function n(){var e=$("#mohe-know_side_nlp_stable");if(e.length>0){e.append('<div class="feedback-wrap"><a href="javascript:;" id="feedback">\u610f\u89c1\u53cd\u9988</a></div>');var n=$("#feedback");n.on("click",function(){So.lib.log(t,{type:"nlp"}),_loader.use("require.2.1.11",function(){require(["/resource/js/feedback.js"],function(t){t.init({$targetDom:e,$feedbackBtn:n,posFlag:0})})})})}}return{nlp:n}}return{}}(),So.web._init=function(){return function(){$("#tips-res-spite .open").toggle(function(){$("#m-result").removeClass("hide-spite"),$("#tips-res-spite span").html("\u90e8\u5206\u7ed3\u679c\u53ef\u80fd\u88ab\u6076\u610f\u7be1\u6539\u6216\u5b58\u5728\u865a\u5047\u3001\u8bc8\u9a97\u7b49\u5185\u5bb9\u3002"),$(this).html("\u9690\u85cf\u6b64\u7c7b\u7ed3\u679c")},function(){$("#m-result").addClass("hide-spite"),$("#tips-res-spite span").html("\u90e8\u5206\u7ed3\u679c\u53ef\u80fd\u88ab\u6076\u610f\u7be1\u6539\u6216\u5b58\u5728\u865a\u5047\u3001\u8bc8\u9a97\u7b49\u5185\u5bb9\uff0c\u5df2\u88ab\u9690\u85cf\u3002"),$(this).html("\u4e86\u89e3\u98ce\u9669\uff0c\u663e\u793a\u6240\u6709\u7ed3\u679c")});var e=$(".cheat-tel-wrap"),t=e.length||0;t>0&&e.on("click",".res-comm-more",function(){var e=$(this);e.hasClass("res-comm-arrow")?(e.siblings(".cheat-tel-all-data").hide(),e.siblings(".cheat-ul").show(),e.removeClass("res-comm-arrow").html("\u5c55\u5f00")):(e.siblings(".cheat-ul").hide(),e.siblings(".cheat-tel-all-data").css({display:"inline"}),e.addClass("res-comm-arrow").html("\u6536\u8d77"))});if($(".mse-qrcode").length>0){var n=$(".mse-qrcode-img");$(".js-mse-qr").on("mouseenter",function(){return n.fadeIn(),!1}),$("body").on("click",function(e){$(this).closest(".mse-qrcode").length==0&&n.fadeOut()})}var r=$("#soSafe"),i=r.find("dt"),s=r.find("dd"),o=r.find("dt div");i.hover(function(){i.addClass("hover")},function(){i.removeClass("hover")}),i.toggle(function(){s.slideDown("fast"),r.addClass("open"),o.html("\u6536\u8d77")},function(){s.slideUp("fast"),r.removeClass("open"),o.html("\u5c55\u5f00")});var u=$("#so_top");if(u.length>0){var a,f,l="pdrs",c=$("#so-pdr-guide").attr("data-ver");u.hasClass("scroll")?(So.lib.log(l,{datatype:"1",value:c,sid:So.comm.monitor.sid}),$(window).on("scroll.haosou",function(){f=$(window).scrollTop(),!a&&f>130?a=1:u.is(":hidden")&&a==1&&f<130&&(So.lib.log(l,{datatype:"scrollshow",value:c,sid:So.comm.monitor.sid}),u.slideDown("fast",function(){$(".so-pdr-box").height()>22&&$(".ac-change").css("visibility","visible")}))})):So.lib.log(l,{datatype:"0",value:c,sid:So.comm.monitor.sid})}So.web.feedback.nlp&&So.web.feedback.nlp()}}(),So.web._init(),So.page.reload.push(So.web._init);